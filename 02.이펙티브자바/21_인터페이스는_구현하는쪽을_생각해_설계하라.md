# 아이템 21. 인터페이스는 구현하는 쪽을 생각해 설계하라.

## 디폴트 메소드란?

기존 인터페이스에 기존 구현체들을 깨뜨리지 않고 메서드를 추가할 수 있도록 하는 디폴트 메서드가 자바8에서 탄생했다. (그전에는 방법이 없었다.)

<br/>

## 디폴트 메소드 문제점

#### 기존 모든 구현체와 매끄럽게 연동되리라는 보장이 없다.

- 디폴트 메서드는 구현 클래스에 대해 아무것도 모른채 삽입될뿐이다.
- 즉 모든 상황에서 불변식을 해치지 않는 디폴트 메서드르 작성하기란 어렵다.

#### 디폴트 메서드는 컴파일에 성공하더라도 기존 구현체에 런타임 오류를 일으킬 수 있다.

<br/>

## 문제 예시

- apache commons 라이브러리의 SynchorizedCollection 클래스는 클라이언트가 제공한 객체로 락을 거는 능력을 추가로 제공하고 내부 컬렉션에 객체 기능을 위임하는 래퍼클래스다.
- 하지만 새로 추가된 removeIf 메서드를 재정의 안했기 때문에 removeIf 구현은 동기화에 대해 모른다.
- 따라서 여러 스레드 공유하는 환경에서 removeIf를 호출하면 오류 발생

<br/>

## 결론

- __기존 인터페이스에 디폴트 메서드로 추가하는건 꼭 필요한 경우가 아니면 피하자.__
    - 디폴트 메서드는 인터페이스로 부터 메서드를 제거하거나 기존 시그니처를 수정하는 용도가 아니다.
- 디폴트 메서드가 있어도 __처음부터 인터페이스 설계할 때 세심한 주의를 기울이자.__
- 새로운 인터페이스라면 릴리스 전 반드시 테스트하자.
    - 다른 방식으로 최소 3가지는 구현하자
