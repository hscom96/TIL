# 20장. 업무 규칙

## 용어 정의

> 업무규칙은 **사업적으로 수익을 얻거나 비용을 줄일 수 있는 규칙 또는 절차** (컴퓨터상 구현했는지는 상관없음)

- ex) 대출에 N%의 이자를 부과하는 사실은 은행이 돈을 버는 업무규칙
    - 이런건 사업 자체에 핵심적이라 **핵심 업무 규칙** 라고 부른다.
- ex) 대출에는 대출 잔액, 이자율, 지급일정
    - 핵심 업무 규칙은 보통 데이터를 요구한다.
    - 이러한 데이터를 **핵심 업무 데이터** 라고 부른다.

핵심 규칙과 데이터는 본질적으로 결합되어 있어 객체로 만들기 좋은 후보인데, 이러한걸 엔티티라고 부른다.

<br/>

## 엔티티

> 엔티티는 컴퓨터 시스템 내부의 객체로서,   
> **핵심 업무 데이터를 기반으로 동작하는 핵심 업무 규칙을 구현한 함수로 구성**된다.

![picture 4](../images/aa3b25dfd0a0ce6cceefdcdb5e81e2a16831f1effbb66917ed3457d8308d4187.png)

- 주의할점은 업무에서 핵심적인 개념을 구현하는 소프트웨어는 한데 모으고, 구축중인 시스템 나머지 모든 고려사항과 분리시키고 독립적으로 존재한다.
    - DB, 사용자 인터페이스 등.. 고려사항에 영향을 받으면 안되고 어떤 시스템에서도 업무를 수행할 수 있다.
- 엔티티는 순전히 업무에 대한 것이다.

<br/>

## 유스케이스

### 정의

- 엔티티내의 핵심업무규칙과는 반대로, 유스케이스는 **애플리케이션에 특화된 업무 규칙** 을 설명한다.
    - 사용자에게 제공해야하는 입력, 보여줄 출력, 해당 출력을 생성하기 위한 처리 단계인 시스템이 사용되는 방법을 기술한다.
- 즉 유스케이스는 **엔티티 내부의 핵심 업무 규칙을 어떻게, 그리고 언제 호출할지를 명시하는 규칙**을 담는다.

### 주의할 점

- 유스케이스는 시스템이 사용자에게 어떻게 들어오고 보이는지를 설명하지 않는다. (웹, 콘솔..) 이보다는 애플리케이션에 특화된 규칙을 설명하며, 이를 통해 사용자와 엔티티 사이의 상호작용을 규정함.

- 유스케이스는 객체다. 애플리케이션에 특화된 업무 규칙을 구현하는 하나 이상의 함수를 제공하고, 데이터 요소를 포함한다.

- 엔티티는 자신을 제어하는 유스케이스에 대해 아무것도 모른다. 즉 엔티티같은 고수준 개념은 유스케이스와 같은 저수준 개념에 대해 아무것도 알지 못한다.

    - 엔티티는 다양한 애플리케이션에 사용될 수 있도록 일반화된 것이므로 각 시스템의 입력과 출력에서 더 멀리 떨어져있음.
    - 유스케이스는 입력과 출력에 가까이있기 때문에 저수준

  <br/>

## 요청 및 응답모델

### 주의사항

1. 제대로 구성된 유스케이스 객체라면 데이터를 사용자나 또 다른 컴포넌트와 주고받는 방식(HTML, SQL..)에 대해서는 전혀 눈치챌 수 없어야한다.
2. 유스케이스는 단순한 요청 데이터 구조를 입력으로 받고, 단순한 응답 데이터 구조를 출력으로 반환한다.
    - 이 데이터 구조는 어떤것도 의존하지않음. (HttpRequest 같은..)
    - 의존성을 제거 안하면 모델에 의존하는 유스케이스도 의존성에 간접적으로 결합
3. 엔티티 객체를 가리키는 참조를 요청/응답 데이터 구조에 포함 시키면 안된다.
    - 왜냐하면 엔티티와 요청/응답 모델은 목적이 서로 다르고 시간이 지날수록 완전히 다른 이유로 변경된다. -> 묶으면 공통 폐쇄 원칙, 단일 책임 원칙 위반

<br/>