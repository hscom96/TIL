# Chapter 14. 자바 모듈 시스템

- 모듈이란? 
  - 서로 밀접하게 연관된 패키지들과 리소스들의 그룹
  - 즉 **자바 패키지들의 패키지**라고 볼 수 있는데, 코드의 재사용성을 높이기 위해 추상화 단계를 하나 더 추가한 것

# 압력: 소프트웨어 유추

## 관심사 분리 (SOC)

- **관심사 분리는 컴퓨터 프로그램을 고유의 기능으로 나누는 동작을 권장**하는 원칙

> - 자바 9 **모듈은 클래스가 어떤 다른 클래스를 볼 수 있는지를 컴파일 시간에 정교하게 제어**할 수 있다. 특히 자바 패키지는 모듈성을 지원하지 않는다.

- 관심사 분리
  - 개별 기능을 따로 작업할 수 있으므로 팀이 쉽게 협업할 수 있다.
  - 개별 부분을 재사용하기 쉽다.
  - 전체 시스템을 쉽게 유지보수 할 수 있다.

## 정보은닉

- **정보 은닉은 세부 구현을 숨기도록 장려하는 원칙**이다.
  - 중요한 이유는 개발할때 요구사항은 자주 바뀌는데 세부 구현을 숨김으로 프로그램의 어떤 부분을 바꿨을때 다른 부분까지 영향을 미칠 가능성을 줄일 수 있다.
- **캡슐화는 특정 코드 조각이 애플리케이션의 다른 부분과 고립되어 있음을 의미**한다.
  - 캡슐화된 코드의 내부적인 변화가 의도치 않게 외부에 영향을 미칠 가능성을 줄인다.



# 자바 모듈 시스템을 설계한 이유



**1. 패키지의 캡슐화가 완벽하지 않다**. 

- 클래스와 관련해서는 접근 제한자로 멤버의 공개 여부를 마음대로 지정. 하지만 **패키지와 JAR 수준에서는 캡슐화를 거의 지원하지 않음**. 
- 클래스를 숨길 수는 있지만 공개 또는 비공개 둘 중 하나만 선택할 수 있어 여러 패키지에서 공용으로 사용할 클래스를 외부에 대해 숨길 수 없다. **공용으로 사용할 클래스를 공개해 버리면 라이브러리 내부 뿐만 아니라 외부에서도 자유롭게 사용할 수 있다.** 클래스는 패키지 내부로 숨길 수 있지만 패키지는 숨겨 두고 내부에서만 사용할 방법이 없다.
- 결과적으로 **이들 클래스와 인터페이스는 모두 공개되고, 사용자가 내부 구현을 마음대로 사용할 수 있**다. 기존의 애플리케이션을 망가뜨리지 않고 라이브러리 코드를 바꾸기가 어려워진다.



 **2. 빌드 단계에서 프로그램 구동에 필요한 모든 클래스가 다 있는지 확인할 수 없다.** 

- 자바는 동적 로딩을 통해 필요한 클래스를 실행중에 로드한다. 덕분에 시작이 빠르고 생성할 클래스를 선택할 수 있지만 실행 직후에는 누락 사실을 바로 알 수 없다는 문제가 있다. 클래스 누락을 방지하려면 실행중에 로드되는 클래스가 다 있는지 수작업으로 일일이 확인하는 수밖에 없다.



**3. 런타임이 거대해져 배포가 어려워졌다.**

- 초기의 자바 플랫폼은 라이브러리의 모든 클래스를 rt.jar라는 단 하나의 파일에 통합하여 배포했다. rt는 런타임(Run Time)이라는 뜻이며 자바 프로그램이 실행되기 위한 모든 클래스가 포함되어 있는 자바 플랫폼 그 자체이다. 단일 파일이라 배포하기 쉽고 별 문제가 없었다. 그러나 자바 버전이 올라 가면서 rt.jar는 용량 60M에 2만개의 클래스를 포함하는 초대형 런타임이 되었고 앞으로는 더 늘어날 것이 뻔하다. PC에서는 별 무리가 없지만 임베디드 장비에 설치하기에는 너무 거대하다. 게다가 단일 파일이라 불필요한 것까지 한꺼번에 배포할 수밖에 없다. 꼭 필요한 클래스만 추려 원하는 런타임을 생성하고 런타임과 프로그램을 같이 배포할 수 있어야 할 필요가 생겼다.

# 자바 모듈 : 큰그림

- 모듈 디스크립터
  - module-info.java라는 특별한 파일에 저장된다.
  - 보통 패키지와 같은 폴더에 위치하며 한개 이상의 패키지를 서술하고 캡슐화할 수 있지만 단순한 상황에서는 이들 패키지 중 한개만 외부로 노출시킴

<img src="https://raw.githubusercontent.com/hscom96/ImageStore/main/images/2023/02/14/image-20230214003025183.png" alt="image-20230214003025183" style="width:50%;" />

<img src="https://raw.githubusercontent.com/hscom96/ImageStore/main/images/2023/02/14/image-20230214003901338.png" alt="image-20230214003901338" style="width:67%;" />



# Reference

- modern Java in action

- 모듈 필요한 이유 
  - https://jenkov.com/tutorials/java/modules.html
  -  https://raspberrylounge.medium.com/%EC%9E%90%EB%B0%94%EC%97%90%EC%84%9C-%ED%8C%A8%ED%82%A4%EC%A7%80-package-%EC%99%80-%EB%AA%A8%EB%93%88-module-%EC%9D%98-%EC%B0%A8%EC%9D%B4%EC%A0%90-16b2eda177b4



